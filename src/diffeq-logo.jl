#!/usr/bin/env julia

using Luxor, Colors

function arrows()
  arrow(Point(164.827, 343.604), Point(163.305, 360.924))
  arrow(Point(177.256, 356.866), Point(175.858, 372.131))
  arrow(Point(367.346, 531.436), Point(384.347, 527.371))
  arrow(Point(164.827, 343.604), Point(163.305, 360.924))
  arrow(Point(177.256, 356.866), Point(175.858, 372.131))
  arrow(Point(367.346, 531.436), Point(384.347, 527.371))
  arrow(Point(548.073, 497.252), Point(562.118, 497.243))
  arrow(Point(549.397, 403.061), Point(537.63, 419.207))
  arrow(Point(577.037, 400.325), Point(569.648, 414.082))
  arrow(Point(404.674, 441.366), Point(391.369, 429.539))
  arrow(Point(477.699, 385), Point(467.134, 390.515))
end

function shape1()
  move(187.741, 303.492)
  curve(184.083, 314.202, 179.22, 336.481, 176.706, 361.252)
  curve(176.205, 366.194, 176.205, 371.394, 176.205, 376.24)
  curve(176.205, 398.677, 177.272, 431.479, 198.238, 464.604)
  curve(214.487, 490.274, 227.324, 501.919, 251.977, 516.323)
  curve(273.239, 528.976, 284.791, 531.195, 303.55, 533.714)
  curve(331.515, 536.013, 344.292, 533.714, 344.292, 533.714)
  curve(365.364, 532.368, 380.865, 529.206, 401.286, 522.399)
  curve(421.566, 515.639, 459.388, 494.442, 474.133, 482.055)
  curve(477.665, 479.088, 491.717, 469.048, 502.797, 457.967)
  curve(513.877, 446.887, 535.315, 421.595, 535.315, 421.595)
  line(542.835, 411.534)
  curve(552.47, 400.694, 566.441, 374.217, 566.441, 374.217)
  curve(566.441, 374.217, 586.192, 341.198, 594.382, 328.673)
  curve(602.572, 316.147, 611.243, 303.492, 623.046, 299.527)
  curve(634.849, 295.562, 648.097, 303.492, 652.433, 306.271)
  curve(656.769, 309.051, 661.345, 312.293, 671.462, 325.06)
  curve(681.579, 337.826, 687.841, 356.373, 692.177, 372.753)
  curve(694.609, 381.941, 696.513, 406.716, 684.71, 434.898)
  curve(672.907, 463.081, 649.542, 482.055, 628.827, 497.744)
  curve(608.112, 513.434, 553.597, 523.781, 531.996, 527.394)
  curve(510.395, 531.007, 476.626, 534.611, 456.12, 538.956)
  curve(435.614, 543.302, 381.931, 550.277, 365.311, 551)
  curve(335.323, 551, 333.594, 551, 303.647, 547.869)
  curve(285.822, 544.737, 274.501, 540.642, 260.289, 535.584)
  curve(246.557, 529.86, 228.416, 517.097, 217.895, 506.92)
  curve(207.538, 498.73, 195.976, 484.519, 189.472, 474.402)
  curve(182.969, 464.285, 174.056, 449.351, 169.239, 431.526)
  curve(164.421, 413.702, 162.818, 389.4, 163.217, 365.127)
  curve(163.312, 359.321, 163.657, 356.572, 164.18, 351.315)
  curve(164.662, 348.425, 165.626, 334.454, 169.239, 319.279)
end

function shape2()
  move(611.802, 377.619)
  curve(623.938, 361.129, 638.046, 364.73, 642.205, 365.538)
  curve(646.365, 366.345, 651.93, 370.746, 655.851, 378.481)
  curve(659.773, 386.215, 662.889, 398.561, 660.463, 410.588)
  curve(658.037, 422.614, 653.659, 432.232, 645.956, 441.694)
  curve(638.253, 451.155, 634.45, 457.096, 623.919, 463.701)
  curve(613.899, 469.984, 612.05, 471.246, 601.541, 474.352)
  curve(591.032, 477.458, 584.939, 477.769, 577.456, 476.98)
  curve(569.972, 476.191, 561.933, 475.128, 556.648, 471.28)
  curve(551.364, 467.431, 550.402, 462.11, 551.577, 456.073)
  curve(553.101, 448.242, 557.508, 437.688, 561.606, 428.732)
  line(575.859, 403.709)
  curve(583.921, 392.675, 593.789, 381.273, 599.57, 372.244)
  curve(637.453, 313.081, 674.659, 348.601, 673.397, 395.336)
  curve(671.398, 469.377, 593.37, 524.1, 474.447, 483.651)
  curve(442.649, 472.836, 398.293, 442.5, 372.032, 408.263)
  curve(343.603, 371.2, 320.876, 317.88, 331.142, 287.699)
  curve(342.231, 255.101, 366.518, 238.918, 398.688, 231.138)
  curve(435.438, 222.25, 469.905, 225.931, 491.508, 239.847)
  curve(515.925, 255.577, 518.614, 266.746, 522.374, 278.857)
  curve(525.578, 289.176, 525.798, 307.475, 522.735, 320.243)
  curve(518.535, 337.752, 501.932, 369.702, 479.775, 384.4)
  curve(456.051, 400.138, 424.439, 398.089, 394.033, 364.822)
end

function circles()
  gsave()
  sethue("black")
  circle(Point(440.5, 323.714), 5, :fill)
  circle(Point(622.894, 427.932), 8, :fill)
  circle(Point(471.887, 484.877), 8, :strokepreserve)
  sethue("white")
  fill()
  grestore()
end

function drawassembly(c)
  gsave()
  sethue(c...)
  # fill shape
  setopacity(0.7)
  shape1() ; fill()
  setcolor("black")
  # outline shape
  shape1() ; stroke()
  shape2() ; stroke()
  circles()
  arrows()
  grestore()
end

function main()
  # semi-official Julia logo colors
  darkerblue     =  (0.251, 0.388, 0.847)
  lighterblue    =  (0.4, 0.51, 0.878)
  darkerpurple   =  (0.584, 0.345, 0.698)
  lighterpurple  =  (0.667, 0.475, 0.757)
  darkergreen    =  (0.22, 0.596, 0.149)
  lightergreen   =  (0.376, 0.678, 0.318)
  darkerred      =  (0.796, 0.235, 0.2)
  lighterred     =  (0.835, 0.388, 0.361)

  for n in 1:3
    gsave()
    rotate((2pi)/3 * n)
    translate(-440.5, -323.714)
    rect(O, 20, 40, :stroke)
    drawassembly([lighterred, lightergreen, lighterpurple][n])
    grestore()
  end
end

Drawing("A4landscape", "/tmp/diff-eq-logo.pdf")
origin()
background("ivory")

tiles = Tiler(currentdrawing.width, currentdrawing.height, 2, 2, margin=20)

for (pt, n) in tiles
  gsave()
  translate(pt)
  setline(n/3)
  scale(n/10, n/10)
  main()
  grestore()
end

finish()
preview()
